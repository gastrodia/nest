FROM gastrodia/node

MAINTAINER gastrodia <gastrodia@outlook.com>


WORKDIR /container

# 安装npm模块
# 使用淘宝的npm镜像
ADD package.json /container/package.json
RUN npm install --production -d --registry=https://registry.npm.taobao.org
RUN npm install -g nodemon --registry=https://registry.npm.taobao.org

# 安装python环境
# 安装pip依赖：setuptools
RUN apt-get install -y python python-dev python-distribute python-pip
ADD egg /container/app/egg
RUN pip install -r app/egg/requires.txt


# 添加源代码
# 运行index.js
ADD . /container/app
WORKDIR /container/app
CMD ["node", "index.js"]